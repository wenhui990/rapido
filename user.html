<!DOCTYPE html>
<!-- Template Name: Rapido - Responsive Admin Template build with Twitter Bootstrap 3.x Version: 1.0 Author: ClipTheme -->
<!--[if IE 8]><html class="ie8" lang="en"><![endif]-->
<!--[if IE 9]><html class="ie9" lang="en"><![endif]-->
<!--[if !IE]><!-->
<html lang="en">
	<!--<![endif]-->
	<!-- start: HEAD -->

	<head>
		<title>经济日报后台管理系统-用户管理</title>
		<!-- start: META -->
		<meta charset="utf-8" />
		<!--[if IE]><meta http-equiv='X-UA-Compatible' content="IE=edge,IE=9,IE=8,chrome=1" /><![endif]-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta content="" name="description" />
		<meta content="" name="author" />
		<!-- end: META -->
		<!-- start: MAIN CSS -->
		<!--<link href='http://fonts.useso.com/css?family=Raleway:400,300,500,600,700,200,100,800' rel='stylesheet' type='text/css'>-->
		<link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.min.css">
		<link rel="stylesheet" href="assets/plugins/iCheck/skins/all.css">
		<link rel="stylesheet" href="assets/plugins/perfect-scrollbar/src/perfect-scrollbar.css">
		<link rel="stylesheet" href="assets/plugins/animate.css/animate.min.css">
		<!-- end: MAIN CSS -->
		<!-- start: CSS REQUIRED FOR SUBVIEW CONTENTS -->
		<link rel="stylesheet" href="assets/plugins/owl-carousel/owl-carousel/owl.carousel.css">
		<link rel="stylesheet" href="assets/plugins/owl-carousel/owl-carousel/owl.theme.css">
		<link rel="stylesheet" href="assets/plugins/owl-carousel/owl-carousel/owl.transitions.css">
		<link rel="stylesheet" href="assets/plugins/summernote/dist/summernote.css">
		<link rel="stylesheet" href="assets/plugins/fullcalendar/fullcalendar/fullcalendar.css">
		<link rel="stylesheet" href="assets/plugins/toastr/toastr.min.css">
		<link rel="stylesheet" href="assets/plugins/bootstrap-select/bootstrap-select.min.css">
		<link rel="stylesheet" href="assets/plugins/bootstrap-switch/dist/css/bootstrap3/bootstrap-switch.min.css">
		<link rel="stylesheet" href="assets/plugins/DataTables/media/css/DT_bootstrap.css">
		<link rel="stylesheet" href="assets/plugins/bootstrap-fileupload/bootstrap-fileupload.min.css">
		<link rel="stylesheet" href="assets/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css">
		<!-- end: CSS REQUIRED FOR THIS SUBVIEW CONTENTS-->
		<!-- start: CSS REQUIRED FOR THIS PAGE ONLY -->
		<!-- end: CSS REQUIRED FOR THIS PAGE ONLY -->
		<!-- start: CORE CSS -->
		<link rel="stylesheet" href="assets/css/styles.css">
		<link rel="stylesheet" href="assets/css/styles-responsive.css">
		<link rel="stylesheet" href="assets/css/plugins.css">
		<link rel="stylesheet" href="assets/css/themes/theme-default.css" type="text/css" id="skin_color">
		<link rel="stylesheet" href="assets/css/print.css" type="text/css" media="print" />
		<!-- end: CORE CSS -->
		<link rel="shortcut icon" href="favicon.ico" />
		<link rel="stylesheet" type="text/css" href="assets/css/index.css" />

	</head>
	<!-- end: HEAD -->
	<!-- start: BODY -->

	<body>
		<div class="main-wrapper">
			<!-- start: TOPBAR -->
			<header class="topbar navbar navbar-inverse navbar-fixed-top inner">
			</header>
			<!-- end: TOPBAR -->
			<!-- start: PAGESLIDE LEFT -->
			<a class="closedbar inner hidden-sm hidden-xs" href="#">
			</a>
			<nav id="pageslide-left" class="pageslide inner">
				<div class="navbar-content">
					<!-- start: SIDEBAR -->
					<div class="main-navigation left-wrapper transition-left">
						<div class="navigation-toggler hidden-sm hidden-xs">
							<a href="#main-navbar" class="sb-toggle-left">
							</a>
						</div>
						<div class="user-profile border-top padding-horizontal-10 block">
							<div class="inline-block" id="role_img">
								<img src="assets/images/圆角.png" width="50" height="50" alt="">
							</div>
							<div class="inline-block">
								<h5 class="no-margin"> Welcome </h5>
								<h4 class="no-margin"> 管理员 </h4>
								<!--<a class="btn user-options sb_toggle">
									<i class="fa fa-cog"></i>
								</a>-->
							</div>
						</div>
						<!-- start: MAIN NAVIGATION MENU -->
						<ul class="main-navigation-menu">

						</ul>
						<!-- end: MAIN NAVIGATION MENU -->
					</div>
					<!-- end: SIDEBAR -->
				</div>
				<div class="slide-tools">
					<div class="col-xs-8 text-left no-padding">
						<a class="btn btn-sm status login_phone wxPhoneLogin" href="#">
							手机号登录
						</a>
						<a class="btn btn-sm status login_wx wxPhoneLogin" href="#">
							微信登录
						</a>
					</div>
					<div class="col-xs-4 text-right no-padding">
						<a class="btn btn-sm log-out text-right" href="#">
							<i class="fa fa-power-off"></i> 退出
						</a>
					</div>
				</div>
			</nav>
			<!-- end: PAGESLIDE LEFT -->
			<!-- start: MAIN CONTAINER -->
			<div class="main-container inner">
				<!-- start: PAGE -->
				<div class="main-content">
					<div class="container" style="height: 20px;">

					</div>
					<div class="container">
						<div class="row">
							<div class="col-sm-12">
								<div class="tabbable">
									<div id="add_indicator_group">
										<input type="text" placeholder="请输入要搜索的用户" id="search_role" />
									</div>
									<ul class="nav nav-tabs tab-padding tab-space-3 tab-blue" id="myTab4">
										<li class="active" data-role="">
											<a data-toggle="tab" href="#panel_overview">
												所有用户
											</a>
										</li>
										<li data-role="0">
											<a data-toggle="tab" href="#panel_common">
												普通用户列表
											</a>
										</li>
										<li data-role="1">
											<a data-toggle="tab" href="#panel_expert">
												专家列表
											</a>
										</li>
										<li data-role="9">
											<a data-toggle="tab" href="#panel_admin">
												管理员列表
											</a>
										</li>
										<li data-role="2">
											<a data-toggle="tab" href="#panel_system">
												系统账户
											</a>
										</li>
										<li data-role="w">
											<a data-toggle="tab" href="#panel_search">
												搜索
											</a>
										</li>
									</ul>
									<div class="tab-content">
										<div id="panel_overview" class="tab-pane fade in active">
											<table class="table table-striped table-bordered table-hover" id="projects">
												<thead>
													<tr>
														<th class="center">#
														</th>
														<th>头像</th>
														<th class="hidden-xs">用户名</th>
														<th>签名</th>
														<th class="hidden-xs">角色</th>
														<th class="hidden-xs">操作</th>
													</tr>
												</thead>
												<tbody>

												</tbody>
											</table>
											<div class="loading"><img src="assets/images/loading.gif" />正在加载中...</div>
										</div>
										<div id="panel_common" class="tab-pane fade">
											<table class="table table-striped table-bordered table-hover" id="projects">
												<thead>
													<tr>
														<th class="center">#
														</th>
														<th>头像</th>
														<th class="hidden-xs">用户名</th>
														<th>签名</th>
														<th class="hidden-xs">角色</th>
														<th class="hidden-xs">操作</th>
													</tr>
												</thead>
												<tbody>

												</tbody>
											</table>
											<div class="loading"><img src="assets/images/loading.gif" />正在加载中...</div>
										</div>
										<div id="panel_expert" class="tab-pane fade">
											<table class="table table-striped table-bordered table-hover" id="projects">
												<thead>
													<tr>
														<th class="center">#
														</th>
														<th>头像</th>
														<th class="hidden-xs">用户名</th>
														<th>签名</th>
														<th class="hidden-xs">角色</th>
														<th class="hidden-xs">操作</th>
													</tr>
												</thead>
												<tbody>

												</tbody>
											</table>
											<div class="loading"><img src="assets/images/loading.gif" />正在加载中...</div>
										</div>
										<div id="panel_admin" class="tab-pane fade">
											<table class="table table-striped table-bordered table-hover" id="projects">
												<thead>
													<tr>
														<th class="center">#
														</th>
														<th>头像</th>
														<th class="hidden-xs">用户名</th>
														<th>签名</th>
														<th class="hidden-xs">角色</th>
														<th class="hidden-xs">操作</th>
													</tr>
												</thead>
												<tbody>

												</tbody>
											</table>
											<div class="loading"><img src="assets/images/loading.gif" />正在加载中...</div>
										</div>
										<div id="panel_system" class="tab-pane fade">
											<table class="table table-striped table-bordered table-hover" id="projects">
												<thead>
													<tr>
														<th class="center">#
														</th>
														<th>头像</th>
														<th class="hidden-xs">用户名</th>
														<th>签名</th>
														<th class="hidden-xs">角色</th>
														<th class="hidden-xs">操作</th>
													</tr>
												</thead>
												<tbody>

												</tbody>
											</table>
											<div class="loading"><img src="assets/images/loading.gif" />正在加载中...</div>
										</div>
										<div id="panel_search" class="tab-pane fade">
											<table class="table table-striped table-bordered table-hover" id="projects">
												<thead>
													<tr>
														<th class="center">#
														</th>
														<th>头像</th>
														<th class="hidden-xs">用户名</th>
														<th>签名</th>
														<th class="hidden-xs">角色</th>
														<th class="hidden-xs">操作</th>
													</tr>
												</thead>
												<tbody>

												</tbody>
											</table>
											<div class="loading"><img src="assets/images/loading.gif" />正在加载中...</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="container" id="pages">
						<div class="row">
							<nav aria-label="...">
								<ul class="pager">
									<li>
										<a href="javascript:;" id="prvePage">上一页</a>
									</li>
									<li>
										跳到
										<input type="text" placeholder="输入页数" style="width: 66px;" id="pageVal" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" />页
										<button id="pageOk">确定</button>
									</li>
									<li>
										<a href="javascript:;" id="nextPage">下一页</a>
									</li>
								</ul>
							</nav>
						</div>
					</div>
				</div>
				<!-- end: PAGE -->
			</div>
			<!-- end: MAIN CONTAINER -->
			<!-- start: FOOTER -->
			<footer class="inner">
			</footer>
			<!-- end: FOOTER -->
			<!-- start: SUBVIEW SAMPLE CONTENTS -->
			<!-- 修改用户资料公用弹窗 -->
			<div class="modal fade" id="dialogRole" tabindex="-1" role="dialog">
				<div class="modal-dialog" role="document">
					<div class="modal-content">
						<div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title">修改用户资料</h4></div>
						<div class="modal-body">
							<form class="form-horizontal">
								<div class="form-group">
									<label for="inputName" class="col-sm-2 control-label">名字</label>
									<div class="col-sm-10">
										<input type="text" class="form-control" id="inputName" placeholder="请输入用户名">
									</div>
								</div>
								<div class="form-group">
									<label for="inputSign" class="col-sm-2 control-label">个性签名</label>
									<div class="col-sm-10">
										<input type="text" class="form-control" id="inputSign" placeholder="请输入个性签名">
									</div>
								</div>
								<!--<div class="form-group">
									<label for="inputIntro" class="col-sm-2 control-label">自我介绍</label>
									<div class="col-sm-10">
										<input type="text" class="form-control" id="inputIntro" placeholder="请输入自我介绍">
									</div>
								</div>-->
								<div class="form-group">
									<label for="" class="col-sm-2 control-label">性别</label>
									<div class="col-sm-10">
										<label class="radio-inline">
  <input type="radio" name="gender" id="man" value="1"> 男
</label>
										<label class="radio-inline">
  <input type="radio" name="gender" id="woman" value="2"> 女
</label>
									</div>
								
								</div>
								<div class="form-group">
									<label for="" class="col-sm-2 control-label">头像</label>
									<div class="col-sm-10">
										<input type="file" name="fileImg" id="fileImg" value="" />
										<div style="margin: 10px 0;">
											<img src="admin/assets/images/anonymous.jpg" id="imgShow"	 width="100" height="100" alt="此用户没有头像"/>
										</div>
									</div>
									
								</div>
							</form>
						</div>
						<div class="modal-footer">
							<button type="button" data-dismiss="modal" class="btn btn-success edit_role_ok">确定</button>
							<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div id="dialogPubic"></div>
			
		<!-- start: MAIN JAVASCRIPTS -->
		<!--[if lt IE 9]>
		<script src="assets/plugins/respond.min.js"></script>
		<script src="assets/plugins/excanvas.min.js"></script>
		<script type="text/javascript" src="assets/plugins/jQuery/jquery-1.11.1.min.js"></script>
		<![endif]-->
		<!--[if gte IE 9]><!-->
		<script src="assets/plugins/jQuery/jquery-2.1.1.min.js"></script>
		<!--<![endif]-->
		<script type="text/javascript">
			$(".main-navigation-menu").load("left_nav.html");
		</script>
		<script src="assets/plugins/jquery-ui/jquery-ui-1.10.2.custom.min.js"></script>
		<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
		<script src="assets/plugins/blockUI/jquery.blockUI.js"></script>
		<script src="assets/plugins/iCheck/jquery.icheck.min.js"></script>
		<script src="assets/plugins/moment/min/moment.min.js"></script>
		<script src="assets/plugins/perfect-scrollbar/src/jquery.mousewheel.js"></script>
		<script src="assets/plugins/perfect-scrollbar/src/perfect-scrollbar.js"></script>
		<script src="assets/plugins/bootbox/bootbox.min.js"></script>
		<script src="assets/plugins/jquery.scrollTo/jquery.scrollTo.min.js"></script>
		<script src="assets/plugins/ScrollToFixed/jquery-scrolltofixed-min.js"></script>
		<script src="assets/plugins/jquery.appear/jquery.appear.js"></script>
		<script src="assets/plugins/jquery-cookie/jquery.cookie.js"></script>
		<script src="assets/plugins/velocity/jquery.velocity.min.js"></script>
		<script src="assets/plugins/TouchSwipe/jquery.touchSwipe.min.js"></script>
		<!-- end: MAIN JAVASCRIPTS -->
		<!-- start: JAVASCRIPTS REQUIRED FOR SUBVIEW CONTENTS -->
		<!--<script src="assets/plugins/owl-carousel/owl-carousel/owl.carousel.js"></script>
		<script src="assets/plugins/jquery-mockjax/jquery.mockjax.js"></script>
		<script src="assets/plugins/toastr/toastr.js"></script>
		<script src="assets/plugins/bootstrap-modal/js/bootstrap-modal.js"></script>
		<script src="assets/plugins/bootstrap-modal/js/bootstrap-modalmanager.js"></script>
		<script src="assets/plugins/fullcalendar/fullcalendar/fullcalendar.min.js"></script>
		<script src="assets/plugins/bootstrap-switch/dist/js/bootstrap-switch.min.js"></script>
		<script src="assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
		<script src="assets/plugins/jquery-validation/dist/jquery.validate.min.js"></script>
		<script src="assets/plugins/bootstrap-fileupload/bootstrap-fileupload.min.js"></script>
		<script src="assets/plugins/DataTables/media/js/jquery.dataTables.min.js"></script>
		<script src="assets/plugins/DataTables/media/js/DT_bootstrap.js"></script>
		<script src="assets/plugins/truncate/jquery.truncate.js"></script>
		<script src="assets/plugins/summernote/dist/summernote.min.js"></script>
		<script src="assets/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
		<script src="assets/js/subview.js"></script>
		<script src="assets/js/subview-examples.js"></script>-->
		<!-- end: JAVASCRIPTS REQUIRED FOR SUBVIEW CONTENTS -->
		<!-- start: JAVASCRIPTS REQUIRED FOR THIS PAGE ONLY -->
		<script src="assets/plugins/bootstrap-paginator/src/bootstrap-paginator.js"></script>
		<script src="assets/plugins/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
		<script src="assets/plugins/jquery.pulsate/jquery.pulsate.min.js"></script>
		<script src="assets/plugins/holder/holder.js"></script>
		<script src="assets/js/ui-elements.js"></script>
		<!-- end: JAVASCRIPTS REQUIRED FOR THIS PAGE ONLY -->
		<!-- start: CORE JAVASCRIPTS  -->
		<script src="assets/js/main.js"></script>
		<!-- end: CORE JAVASCRIPTS  -->
		
		<script src="http://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js"></script>
		<script src="assets/js/jquery.cookie.js" type="text/javascript" charset="utf-8"></script>
		<script src="assets/js/public.js" type="text/javascript" charset="utf-8"></script>
		<script>
			jQuery(document).ready(function() {
				Main.init();
				//				SVExamples.init();
				UIElements.init();
				var _url = window.location.href;
				var tabId = _url.split('#')[1];
				var _id = '#'+tabId || '#panel_overview',n=1,role=null,_name,userId;
				
				$("#pageVal").val(n);
				role = roleTabClick(n,_name);
				
				// 点击上一页下一页
				$(document).on("click", "#prvePage,#nextPage", function() {
					$('.loading').show();
					$("#projects").find("tbody").html('');
					var cv = $(this).attr("id");
					cv === 'prvePage' ? --n : ++n;
					if(n < 1) n = 1;
					$("#pageVal").val(n);
					loadUsers(n,role,_id,_name);
				});

				// 点击确定跳转页面
				$(document).on("click", "#pageOk", function() {
					$('.loading').show();
					$("#projects").find("tbody").html('');
					var pageVal = $("#pageVal").val();
					if(pageVal.length < 0) {
						$('#dialogPulic').find('.modal-body').text('请输入要跳到的页数！');
						$('#dialogPulic').modal('show');
						$("#pageVal").focus();
					}
					if(pageVal < 1) {
						$("#pageVal").val(1);
					}
					loadUsers(pageVal,role,_id,_name);
					n = pageVal;
				});
				
				$('#pageVal').on('keyup',function(e){
					if (e.keyCode===13) {
						$('#pageOk').click();
					}
				});
				
				// 键盘延迟事件只执行最后一次方法
				var _timer = {};
				function delay_till_last(id, fn, wait) {
				    if (_timer[id]) {
				        window.clearTimeout(_timer[id]);
				        delete _timer[id];
				    }
				
				    return _timer[id] = window.setTimeout(function() {
				        fn();
				        delete _timer[id];
				    }, wait);
				}

				
				// 搜索用户
				$(document).on('keyup','#search_role',function(e){
					_name = $(this).val();
					_id = '#panel_search';
					n=1;
					role = 'w'
					delay_till_last('search_role', function(){
						window.history.pushState('',0,_id);
						roleTabClick(n,_name);
					}, 500);
				});
				
				// 修改用户角色
				$(document).on("change", ".roles", function() {
					var role = $(this).val();
					var _idEdit = $(this).parents("tr").find("td").first().text();
					$(this).find('option').attr('selected','false');
					//					console.log(_id);
					editRole(_idEdit, role);
				});

				// 更新用户资料
				$(document).on('click', '.edit_role', function() {
					var fileId = '#fileImg',imgId = '#imgShow';
					if(!!window.ActiveXObject || "ActiveXObject" in window){
						uploadImg(fileId, imgId);
					}else{
						$(document).on("change", fileId, function() {
							uploadImg(fileId, imgId);
						});
					}
					userId = $(this).attr('data-id');
					$.ajax({
						type:"get",
						url: _href + interfacelist.user + userId,
						async:true,
						success: function(data){
							$('#inputName').val(data.name);
							$('#inputSign').val(data.sign);
							$(':radio[name="gender"][value="'+data.gender+'"]').attr('checked','true');
							$(imgId).attr('src',data.head);
//							$('.edit_role').off();
						}
					});
					$('#dialogRole').modal('show');
					
				});
				$('.edit_role_ok').click(function(){
					editRole(userId, "",'userEdit');
//					$('.edit_role_ok').off();
				});
				
				// 点击标签切换状态
				$("#myTab4").on('click','li',function(){
					n=1;
					$("#pageVal").val(n);
					$('.loading').show();
					role = $(this).attr("data-role");
					_id = $(this).find('a').attr("href");
					$(_id).find('tbody').html('');
					window.history.pushState({},0,_id); 
					loadUsers(n,role,_id,_name);
				});
				
				
				window.glUser = {
					'userN':n,
					'userRole':role,
					'userId': _id,
					'userName':_name
				}
				
			});
		</script>
	</body>
	<!-- end: BODY -->

</html>